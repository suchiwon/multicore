멀티코어 프로그래밍 과제1 설명
==============================

## 1. 사용 알고리즘
------------------------------
### *1.1. 경로 찾기*<br>
집과 도로로 이루어진 그래프가 비가중치 그래프이므로 출발지로부터의 깊이값을 저장하는 BFS 탐색으로 거리를 계산했습니다.<br>
현재 탐색 큐를 전부 검사하면서 다음 깊이 큐에 저장한 후 현재 탐색 큐에 옮겨 모든 교차로를 탐색합니다.<br>
### *1.2. 자료구조와 메모리 사용*<br>
그래프 정보 저장과 BFS 정보(집으로부터 각 교차로까지의 거리,방문 여부)는 가변 배열인 vector를 전역 변수로 사용합니다.<br>
그래프 정보에는 각 vertex에 edge가 최대로 10개까지 존재할 수 있으므로 sizeof(int) * (1 + 10)V = 44V의 메모리를 사용하고
하나의 BFS 탐색에는 4V(거리= int) + 1V(방문여부=bool) + 8V(최대 큐 용량) = 13V의 메모리가 사용됩니다.

### *1.3. 멀티스레드 방법*<br>
현재 멀티스레드 생성은 동시에 집에서 BFS를 검사하는데 사용하고 있습니다. 이때 각 BFS 정보를 따로 관리해야하므로 
BFS 정보 배열을 집의 크기에 따라 가변적으로 할당하는데 메모리의 한계와 race condition의 방지를 위해
할당은 최대 스레드 개수를 정해서 실행합니다. 현재 지정값은 최대 집의 갯수의 1/3인 22개입니다.<br>
이 때, 코어가 남으므로 현재 실행 중인 스레드 중 하나를 병렬 bfs로 실행합니다.<br>
병렬 bfs는 현재 탐색 큐를 스레드를 생성해 배열 큐의 인덱스를 나눠서 검사하게 됩니다.<br>
이 과정에서 큐에 충돌이 일어나면 안되므로 mutex_lock를 사용합니다.<br>
각 스레드는 먼저 BFS 탐색 여부 배열을 초기화 한 후 BFS를 실행하고 종료됩니다.<br>
main 스레드는 BFS 탐색 스레드가 모두 종료되고나서 최대, 최소값을 구합니다.<br>

## 2. 프로그램 코드 구조 및 컴파일 방법
-----------------------------
### *2.1. 코드 구조*<br>
코드 파일 중 헤더 파일은 /include 경로에 global.h 하나가 존재하고 소소스 파일은 /src 경로에 global.cpp, bfs.cpp, main.cpp가 있습니다.<br>
    -global.h, .cpp<br>
        전역 변수선언과 배열 초기화, 계산된 거리 배열에서 최대, 최소값 계산 함수가 있습니다.<br>
    -bfs.cpp<br>
        스레드의 생성 및 실행 함수와 BFS 함수가 있습니다.<br>
    -main.cpp<br>
        메인 함수가 있습니다. 위의 두 코드의 함수를 이용해 거리를 구합니다.<br>

### *2.2. 컴파일 방법*<br>
프로젝트1 루트 경로에 Makefile이 있습니다.<br>
make 명령어 실행시 bin 디렉토리가 있으면 안되므로 make clean 명령을 먼저 해주고 make 명령을 실행하면
bin 경로에 Project1_test 실행 파일이 생성됩니다.<br>

## 3. 프로그램 실행 방법<br>
/bin/Project1_test 를 실행하는데 standard input으로 input file 을 입력값으로 주면 됩니다.<br>
예시로 /bin/Project1_test < input.txt 의 형식으로 입력하시면 됩니다.<br>

## 4. 보완점<br>
 -현재 자료구조를 stl의 vector 사용중인데 자료구조의 할당과 탐색 속도가 늦을 경우 자료구조의 변경 필요<br>
 -메모리의 활용 및 초기화 방식 개선<br>
 
## 5. 실행 결과<br>
 -실행해본 방법은 <br>
    -bfs에서 동시 진행 스레드를 최대 코어 갯수만큼 할당해준것<br>
    -동시 진행 스레드 갯수를 줄이고 코어 일부를 병렬 bfs에 사용<br>
    2가지 방법이었는데 2번째 방법이 더 빠를거라 예상했으나 배열의 지속적인 할당, lock의 사용으로 기존 방식이 조금 더 나은 성능을 보였습니다.
    코어를 최대한 활용하려해도 구조에 문제가 있으면 성능이 좋지 않음을 확인했습니다.
 